From bf9638c7d70aecdffc6ded02c9fdd562d47d5e53 Mon Sep 17 00:00:00 2001
From: Ioan-Adrian Ratiu <adrian.ratiu_at_ni.com>
Date: Mon, 21 Jul 2014 15:02:35 -0500
Subject: [PATCH] Added curl_easy_getinfo_va() API function

Added API function with `va_list` variable argument parameter in
addition to cURL's function using `...`.

Upstream-Status: Denied

https://curl.se/mail/lib-2017-01/0135.html

This patchset was denied by upstream because they did not agree that our
usecase for these added functions were valid - and we did not have a
defense.

https://curl.se/mail/lib-2017-01/0146.html

Signed-off-by: Alex Stewart <alex.stewart@ni.com>
---
 lib/easy.c | 17 +++++++++++++----
 1 file changed, 13 insertions(+), 4 deletions(-)

diff --git a/lib/easy.c b/lib/easy.c
index 6b4fb8e..8e06b16 100644
--- a/lib/easy.c
+++ b/lib/easy.c
@@ -819,18 +819,27 @@ void curl_easy_cleanup(struct Curl_easy *data)
  * information from a performed transfer and similar.
  */
 #undef curl_easy_getinfo
-CURLcode curl_easy_getinfo(struct Curl_easy *data, CURLINFO info, ...)
+CURLcode curl_easy_getinfo_va(struct Curl_easy *data, CURLINFO info, va_list arg)
 {
-  va_list arg;
   void *paramp;
   CURLcode result;
 
-  va_start(arg, info);
   paramp = va_arg(arg, void *);
-
   result = Curl_getinfo(data, info, paramp);
 
+  return result;
+}
+
+#undef curl_easy_getinfo
+CURLcode curl_easy_getinfo(struct Curl_easy *data, CURLINFO info, ...)
+{
+  CURLcode result;
+  va_list arg;
+  va_start(arg, info);
+
+  result = curl_easy_getinfo_va(data, info, arg);
   va_end(arg);
+
   return result;
 }
 
